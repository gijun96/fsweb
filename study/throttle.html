<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    .container{
      width: 300px;
      height: 300px;
      background-color: rebeccapurple;
      overflow: scroll;
    }
    .content{
      width: 300px;
      height: 1000vh;
    }
  </style>  
</head>
<body>
  <div class="container">
    <div class="content"></div>
  </div>
  <div>
    일반 이벤트 핸들러가 scroll 이벤트를 처리한 횟수:
    <span class="nomal-count">0</span>
  </div>
  <div>
    스로틀 이벤트 핸들러가 scroll 이벤트를 처리한 회수:
    <span class="throttle-count">0</span>
  </div>

  <script>
    const $container = document.querySelector('.container');
    const $nomal_count = document.querySelector('.nomal-count');
    const $throttleCount = document.querySelector('.throttle-count');

    const throttle = (callback, delay) =>{
      let timerId;
      // throttle 함수는 timerId를 기억하는 클로저를 반환한다.
      return (...arg) =>{
        // delay가 경과하기 이전에 이벤트가 발생하면 아무것도 하지 않다가
        // delay가 경과했을때 이벤트가 발생하면 새로운 타이머를 재설정한다.
        // 따라서 delay 간격으로 callback이 호출된다.
        if(timerId) return;
        timerId = setTimeout(() =>{
          callback(...arg);
        timerId =null;
      }, delay)
    }
  }

  let nomalCount = 0;
  $container.addEventListener('scroll', ()=>{
    $nomal_count.textContent = ++nomalCount;
  });
  let throttleCount = 0;
  // throttle 함수가 반환하는 클로저가 이벤트 핸들러로 등록된다.
  $container.addEventListener('scroll', throttle(()=>{
    $throttleCount.textContent = ++throttleCount;
  }, 100));
    

  </script>
</body>
</html>